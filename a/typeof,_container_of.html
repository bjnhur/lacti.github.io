<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>typeof, container_of</title>
    <link href='../res/main.css' rel='stylesheet' type='text/css' />
	<link href="http://yui.yahooapis.com/pure/0.3.0/grids-min.css" rel="stylesheet">
    <link href='http://alexgorbatchev.com/pub/sh/current/styles/shCore.css' rel='stylesheet' type='text/css' />
    <link href='http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css' rel='stylesheet' type='text/css' />
    <script src='http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js' type='text/javascript'></script>
    <script src='http://alexgorbatchev.com/pub/sh/current/scripts/shAutoloader.js' type='text/javascript'></script>
    <script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js' type='text/javascript'></script>
    <script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJScript.js' type='text/javascript'></script>
    <script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCSharp.js' type='text/javascript'></script>
    <script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCpp.js' type='text/javascript'></script>
    <script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJava.js' type='text/javascript'></script>
  </head>
  <body>
    <div id='title'>
      <h1>typeof, container_of</h1>
    </div>
    <div id='content'>
gcc의 additional standard?라고 하는데 generics를 지원하기 위한 도구가 만능 void * 이외에 이런 것도 있겠구나 ㄷㄷ<br />
http://gcc.gnu.org/onlinedocs/gcc/Typeof.html<br />
<br />
저번에 용태씨께 말씀드렸던 어떤 struct 내부 변수의 주소와, 그 struct의 typename을 알 때, struct 변수의 시작 주소를 알아내는 container_of라는 매크로가 커널 내에 선언되어있죠.<br />
http://forum.falinux.com/zbxe/?document_srl=531954<br />
<br />
간단히 설명하면 ((type *) NULL)->var 는 분명히 access violation이 나겠지만, 주소를 얻어내는 & 연산자가 붙으면<br />
컴파일러에서 실행 전(!)에 주소 값을 구해주기 때문에 &((type *) NULL)->var 는 해당 struct 변수에서 멤버 변수의 주소가 얼마나 떨어져있나를 알 수 있죠.<br />
<br />
덕분에 역으로, 해당 멤버 변수의 주소를 알게 되면 저 "떨어진 길이"를 역으로 빼서 struct 변수의 주소를 구할 수 있다.<br />
가 되겠습니다.<br />

    </div>
    <div id='clear'></div>
  </body>
  <script type='text/javascript'>
    SyntaxHighlighter.all();
  </script>
</html>