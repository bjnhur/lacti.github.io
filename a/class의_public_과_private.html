<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="blog">
    <meta name="author" content="lacti">

    <title>class의 public 과 private</title>

    <link href="../css/bootstrap.css" rel="stylesheet">
    <link href="../css/blog-post.css" rel="stylesheet">

	<!-- Syntax highlighter -->
    <link href="../css/shThemeEclipse.css" rel="stylesheet" type="text/css" />
    <link href="../css/shCore.css" rel="stylesheet" type="text/css" />
</head>

<body>

    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">#</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="#about">About</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <div class="container">

        <div class="row">
            <div class="col-lg-8">

                <h2>class의 public 과 private</h2>
                <p>
                    <span class="glyphicon glyphicon-time"></span> Posted on July 20, 2011 at 9:03 PM</p>
                <hr>
                <div class="content">
#<br />
이 글은 단순히 까는 글, 어떠한 정보도 포함하고 있지 않다.<br />
<br />
#<br />
예전에 윤호 선배님께서 어떤 코드를 수정하시면서 하셨던 말이 있다.<br />
"왜 멤버가 다 public 으로 되어있는거야!"<br />
<br />
#<br />
요즘 코드를 읽고 있는데 몇 개의 class 들이 저런 문제점을 지니고 있다.<br />
다음 예제를 보자.<br />
<br />
<pre class="brush: cpp">class Worker
{
public:
    void DoWork();
    void Run();
    void Append(Work*);
    void Remove(Work*);
    Work* GetWork(int);
public:
    volatile long workCount;
    Work* workArray;
};</pre>
(volatile keyword 를 사용한 이유는 다음에 설명하겠다)<br />
<br />
저런 class가 있다고 할 때 저 interface 만 보고 class가 무슨 일을 하는지 알 수 있을까?<br />
<br />
이름도 적절히 Worker 이고, DoWork 와 Run 함수를 보니 Work 를 실행해주는 것 같고,<br />
Append와 Remove가 있으니 뭔가 Work 를 넣었다 뺐다도 할 수 있나보다.<br />
그리고 GetWork 라는게 있으니까 뭔가 Work 객체를 가져올 수도 있나보다.<br />
그리고 WorkCount, WorkArray 가 있으니 내부에서 Work 객체를 저장하나보네? 그런데 public? <br />
<br />
그리고 로직 코드를 읽고 나서야 DoWork, Remove, GetWork 함수는 오로지 Worker 내부에서만 사용되고, 외부에서는 Run과 Append 함수만 사용한다는 것을 알게 되었다.<br />
그리고 workCount 를 직접 접근하는 곳도 발견되었다 -_-<br />
<br />
여기까지 읽은 사람이라면 수도 없이 많은 문제를 떠올리겠지만, 다 생략하고 몇 개만 보겠다.<br />
<br />
1) class 의 역할을 파악하고 동작을 이해함에 있어 private 의 역할은 꽤나 중요하다. public method 는 외부에서 호출한다는 것이니까, 결국 이 class가 어떤 동작을 외부로 제공해줄지를 결정하는 것이기 때문이다. 위의 class를 제대로 적어보면,<br />
<pre class="brush: cpp">class Worker
{
public:
    void Run();
    void Append(Work*);
    long GetWorkdCount();
private:
    void DoWork();
    void Remove(Work*);
    Work* GetWork(int);
private:
    volatile long workCount;
    Work* workArray;
};</pre>
와 같이 되어야하지 않을까. 개인적으로 private나 protected 구간도 여러 개로 설정해서 member, variable, static 을 또 나누어서 표현한다. 혹자는 아예 public method 의 가장 아래 부분에 생성자, 소멸자를 적음으로써 이 밑으로는 볼 필요가 없다는 convention 을 제시하기도 했다.<br />
<br />
2) refactoring 등을 할 때 coverage 를 설정하기 위해서라도 private은 중요하다. 여기저기에서 호출하고 있는 method를 refactoring을 하는건 고난의 행군이 될 것이다. 최대한 외부로 노출되는 method 를 줄이고 private로 꽁꽁 묶어놔야 기능이나 설계를 개선할 때 수정으로 인해 영향을 받는 외부 부분이 줄어들면서 그나마 좀 나아지지 않을까 싶다.<br />
<br />
이 이야기는 결국 귀에 못이 박히도록 들어온 encapsulation 이야기인데,<br />
이런 저런걸 고려해볼 때 friend 의 등장은 저걸 저해하는 것 같으면서도 잘 구성할 수 있게 해준다.<br />
<br />
private member variable 이야 getter 로 빼준다 할지라도, method 의 경우는 접근할 방법이 없으니까.<br />
(뭐 미친 척 하고 member function pointer 를 넘기면 되지 않을까 싶지만)<br />
<br />
그런데 결국 friend 를 해주면 coverage에 구멍이 생기니까 별로 좋은 일은 아니다.<br />
java의 package나 c#의 internal 같은 나름 우아한 방법으로 묶어주는 것도 좋을텐데 일단 C++은 그런게 없으니 namespace로 수작이라도 부려봐야지<br />

				</div>
                <hr>

                <!-- the comments -->
				<div id="disqus_container">
					<div id="disqus_thread"></div>
					<script type="text/javascript">
						var disqus_shortname = 'lacti';
						(function() {
							var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
							dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
							(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
						})();
					</script>
					<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
					<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
				</div>
            </div>

            <div class="col-lg-4 sides">

                <div class="well">
					<h4>Recents <a href="/" class="show-all">(all)</a></h4>
					<ul>

						<li><a href="/a/패킷_enum에_따른_packet_콜백_함수_자동생성.html">패킷 enum에 따른 packet 콜백 함수 자동생성</a> <span class="date">11. 19.</span></li>
						<li><a href="/a/비동기_프로그래밍_패턴__2.html">비동기 프로그래밍 패턴 #2</a> <span class="date">11. 19.</span></li>
						<li><a href="/a/비동기_프로그래밍_패턴.html">비동기 프로그래밍 패턴</a> <span class="date">10. 9.</span></li>
						<li><a href="/a/websocket,_webRTC.html">websocket, webRTC</a> <span class="date">9. 7.</span></li>
						<li><a href="/a/여의도_스터디_정리__4.html">여의도 스터디 정리 #4</a> <span class="date">8. 26.</span></li>
						<li><a href="/a/여의도_스터디_정리__3.html">여의도 스터디 정리 #3</a> <span class="date">8. 18.</span></li>
						<li><a href="/a/여의도_스터디_과제_풀이__2.html">여의도 스터디 과제 풀이 #2</a> <span class="date">8. 12.</span></li>
					</ul>
                </div>
                <!-- /well -->
				<gcse:search></gcse:search>
            </div>
        </div>

        <footer>
			<hr>
            <div class="row">
                <div class="col-lg-12">
                    <p>Copyright &copy; lacti 2014</p>
                </div>
            </div>
        </footer>

    </div>
    <!-- /.container -->

    <!-- JavaScript -->
    <script src="../js/jquery-1.10.2.js"></script>
    <script src="../js/bootstrap.js"></script>

	<script>
	  (function() {
		var cx = '001870890642618183212:k8iqprsstre';
		var gcse = document.createElement('script');
		gcse.type = 'text/javascript';
		gcse.async = true;
		gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
			'//www.google.com/cse/cse.js?cx=' + cx;
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(gcse, s);
	  })();
	</script>
	
    <script src="../js/shCore.js" type="text/javascript"></script>
    <script src="../js/shAutoloader.js" type="text/javascript"></script>
	<script>
		if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
			// do nothing
		} else {
			SyntaxHighlighter.autoloader(
			  'bash shell             ../js/shBrushBash.js',
			  'cpp c                  ../js/shBrushCpp.js',
			  'c# c-sharp csharp      ../js/shBrushCSharp.js',
			  'css                    ../js/shBrushCss.js',
			  'java                   ../js/shBrushJava.js',
			  'js jscript javascript  ../js/shBrushJScript.js',
			  'php                    ../js/shBrushPhp.js',
			  'text plain             ../js/shBrushPlain.js',
			  'py python              ../js/shBrushPython.js',
			  'ruby rails ror rb      ../js/shBrushRuby.js',
			  'sql                    ../js/shBrushSql.js',
			  'xml xhtml xslt html    ../js/shBrushXml.js'
			);
			SyntaxHighlighter.defaults['toolbar'] = false;
			SyntaxHighlighter.all();
		}
	</script>
</body>

</html>
